{% extends "base.html" %}
{% load i18n django_bootstrap5 %}

{% block title %}{% trans "Tasks" %}{% endblock %}

{% block content %}
  <h1 class="mb-4">{% trans "Tasks" %}</h1>

  <form method="get" class="mb-3">
    <div class="row g-3 align-items-end">
      <div class="col-md-3">
        <label class="form-label" for="id_status">{% trans "Status" %}</label>
        {{ filter.form.status }}
      </div>

      <div class="col-md-3">
        <label class="form-label" for="id_executor">{% trans "Executor" %}</label>
        {{ filter.form.executor }}
      </div>

      <div class="col-md-3">
        <label class="form-label" for="id_label">{% trans "Label" %}</label>
        {{ filter.form.label }}
      </div>

      <div class="col-md-2 form-check mt-4">
        {{ filter.form.self_tasks }}
        <label class="form-check-label" for="id_self_tasks">
          {% trans "Only my tasks" %}
        </label>
      </div>

      <div class="col-md-1">
        <button type="submit" class="btn btn-primary w-100">
          {% trans "Show" %}
        </button>
      </div>
    </div>
  </form>

  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th>{% trans "ID" %}</th>
        <th>{% trans "Name" %}</th>
        <th>{% trans "Status" %}</th>
        <th>{% trans "Author" %}</th>
        <th>{% trans "Executor" %}</th>
        <th>{% trans "Labels" %}</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for task in tasks %}
        <tr>
          <td>{{ task.id }}</td>
          <td>
            <a href="{% url 'tasks:detail' task.pk %}">
              {{ task.name }}
            </a>
          </td>
          <td>{{ task.status }}</td>
          <td>{{ task.author }}</td>
          <td>{{ task.executor|default:"–" }}</td>
          <td>
            {% for label in task.labels.all %}
              <span class="badge bg-secondary">{{ label.name }}</span>
            {% empty %}
              –
            {% endfor %}
          </td>
          <td class="text-end">
            <a class="btn btn-sm btn-outline-primary"
               href="{% url 'tasks:update' task.pk %}">
              {% trans "Edit" %}
            </a>
            <a class="btn btn-sm btn-outline-danger"
               href="{% url 'tasks:delete' task.pk %}">
              {% trans "Delete" %}
            </a>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="7" class="text-center">
            {% trans "No tasks yet" %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
